---
description: Ã–versikt av testplanen fÃ¶r att sÃ¤kerstÃ¤lla funktionalitet i Inner Journey
id: testplan-2025
sidebar_label: Testplan
sidebar_position: 10
slug: testplan-2025
tags:
- testplan
- frontend
- backend
- api
- dialogflow-cx
- integration
title: Testplan
---

# ğŸ“ Testplan fÃ¶r Inner Journey

HÃ¤r Ã¤r information om detta dokument:

*   âœ¨ **Version:** 3
*   ğŸ—“ï¸ **Datum:** `2025-03-21`
*   ğŸ‘¤ **FÃ¶rfattare:** Bo Joel Kvarnsmyr
*   âœï¸ **Senast reviderad av:** Bo Joel Kvarnsmyr

## ğŸ¯ Syfte

Denna testplan syftar till att sÃ¤kerstÃ¤lla att alla komponenter i `Inner Journey`-projektet fungerar korrekt och enligt specifikation.

Detta omfattar tester av:
*   Frontend
*   Backend
*   Externa integrationer
*   `Dialogflow CX`-samtalsflÃ¶det

HuvudmÃ¥let Ã¤r att identifiera och dokumentera eventuella buggar eller funktionsbrister innan lansering av nya funktioner, sÃ¥som integrationen med `Firebase`.

## ğŸ’» TestmiljÃ¶

FÃ¶ljande komponenter och adresser utgÃ¶r testmiljÃ¶n:

*   ğŸŒ **Frontend:** `React`-applikationen kÃ¶rs lokalt pÃ¥ `http://localhost:3000`. FÃ¶r extern Ã¥tkomst anvÃ¤nds `ngrok` (exempeladress: `https://abc123.ngrok.io`).
*   â˜ï¸ **Backend:** `FastAPI`-applikationen Ã¤r tillgÃ¤nglig via `https://api.backend.kvarnsmyr.se`.
*   ğŸ“ **Telefonnummer:** Ett dedikerat testnummer (`+447418631211`) anvÃ¤nds via `Sinch Voice API`.
*   ğŸ’¬ **Dialogflow CX:** AI-agenten Ã¤r konfigurerad och hanteras via `Google Cloud Console`.

## âœ… Testfall

Nedan fÃ¶ljer specifika testfall som tÃ¤cker systemets kÃ¤rnfunktionalitet.

### ğŸ–¥ï¸ Frontend

1.  **Testfall: Inmatning av anvÃ¤ndaruppgifter**
    *   **Steg:** ğŸ‘Ÿ Fyll i fÃ¤lten `personalNumber`, `birthTime` och `verificationCode` i formulÃ¤ret. Klicka sedan pÃ¥ knappen `"Begin Journey"`.
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… Data skickas korrekt till backend-endpointen `/init-verification`. Ett telefonsamtal initieras till det angivna testnumret. ğŸ‘

2.  **Testfall: Inmatning av mottagen verifieringskod**
    *   **Steg:** ğŸ‘Ÿ Efter att ha mottagit koden via telefonsamtalet, mata in den i det avsedda fÃ¤ltet. Klicka pÃ¥ knappen `"Verify Code"`.
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… Koden skickas till backend-endpointen `/verify-code` fÃ¶r validering. Om koden Ã¤r korrekt fortsÃ¤tter samtalsflÃ¶det som fÃ¶rvÃ¤ntat. ğŸ‘

### ğŸ—£ï¸ Samtal (Dialogflow CX)

1.  **Testfall: Korrekta AI-meddelanden**
    *   **Steg:** ğŸ§ Initiera ett testsamtal. Lyssna noggrant pÃ¥ de meddelanden som AI-agenten levererar i olika steg av samtalsflÃ¶det.
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… Agenten ska leverera fÃ¶ljande meddelanden vid respektive steg:
        *   `StartPage`: "Hello!"
        *   `SecureLine`: "First of all..."
        *   `userReady`: VÃ¤ntar pÃ¥ anvÃ¤ndarens bekrÃ¤ftelse ("Yes").
        *   `VerifyCode`: "Your verification code is 123456..." (Notera: Den faktiska koden som anges kommer att variera). ğŸ‘

2.  **Testfall: RÃ¶stbekrÃ¤ftelse i `userReady`-steget**
    *   **Steg:** ğŸ—£ï¸ NÃ¤r AI-agenten befinner sig i `userReady`-steget och vÃ¤ntar pÃ¥ input, svara tydligt med "Yes".
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… SamtalsflÃ¶det ska korrekt Ã¶vergÃ¥ till nÃ¤sta steg, `VerifyCode`. ğŸ‘

### âš™ï¸ Backend (API Endpoints)

1.  **Testfall: Initiering av samtal via `/init-verification`**
    *   **Steg:** ğŸš€ AnvÃ¤nd `curl` fÃ¶r att skicka en `POST`-fÃ¶rfrÃ¥gan till endpointen med nÃ¶dvÃ¤ndig data:
        ```bash
        curl -X POST https://api.backend.kvarnsmyr.se/init-verification \
             -H "Content-Type: application/json" \
             -d '{"personalNumber": "19900101-1234", "verificationCode": "123456", "birthTime": "14:30"}'
        ```
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… API:et ska returnera ett JSON-svar som indikerar att initieringen startat: `{"status": "Verification initiated"}`. ğŸ‘

2.  **Testfall: Validering av kod via `/verify-code`**
    *   **Steg:** ğŸš€ AnvÃ¤nd `curl` fÃ¶r att skicka en `POST`-fÃ¶rfrÃ¥gan till endpointen, inklusive ett giltigt `sessionId` och den mottagna `code`:
        ```bash
        curl -X POST https://api.backend.kvarnsmyr.se/verify-code \
             -H "Content-Type: application/json" \
             -d '{"sessionId": "abc123", "code": "123456"}'
        ```
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… API:et ska returnera ett JSON-svar som bekrÃ¤ftar valideringen: `{"status": "Code verified"}`. ğŸ‘

### ğŸ§˜ Ã–vningar

1.  **Testfall: SlutfÃ¶rande av Hemisync-Ã¶vningen**
    *   **Steg:** ğŸ§ AnvÃ¤nd frontend-grÃ¤nssnittet fÃ¶r att starta och lyssna igenom ljudfilen fÃ¶r Hemisync-Ã¶vningen. âœï¸ Efter Ã¶vningen, skriv och spara en reflektion via grÃ¤nssnittet.
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… Reflektionen skickas framgÃ¥ngsrikt till backend-endpointen `/save-reflection` och sparas. ğŸ‘

2.  **Testfall: SlutfÃ¶rande av "Bridge The Gap"-Ã¶vningen**
    *   **Steg:** ğŸ¬ AnvÃ¤nd frontend-grÃ¤nssnittet fÃ¶r att titta pÃ¥ videon fÃ¶r "Bridge The Gap"-Ã¶vningen. âœï¸ Efter Ã¶vningen, skriv och spara en journalanteckning om upplevelsen via grÃ¤nssnittet.
    *   **FÃ¶rvÃ¤ntat resultat:** âœ… Journalanteckningen skickas framgÃ¥ngsrikt till backend-endpointen `/save-reflection` och sparas. ğŸ‘

## ğŸ§ª Testmetoder

FÃ¶ljande metoder anvÃ¤nds fÃ¶r att genomfÃ¶ra testerna:

*   ğŸ–ï¸ **Manuella tester:** AnvÃ¤nds huvudsakligen fÃ¶r att:
    *   Verifiera anvÃ¤ndarinteraktioner och flÃ¶den i frontend.
    *   UtvÃ¤rdera kvaliteten och korrektheten i samtalsflÃ¶det via `Dialogflow CX`.
*   ğŸ¤– **Automatiserade tester:** Backend-API:ets endpoints testas med `pytest`. Testerna kÃ¶rs frÃ¥n terminalen med fÃ¶ljande kommando:
    ```bash
    pytest tests/test_endpoints.py
    ```

## ğŸ› FelsÃ¶kningssteg

Om problem uppstÃ¥r under testningen, fÃ¶lj dessa steg fÃ¶r att identifiera orsaken:

*   **Frontend:** ğŸ” Inspektera webblÃ¤sarens utvecklarverktyg. Kontrollera specifikt:
    *   Konsolloggar (`Console`) fÃ¶r JavaScript-fel.
    *   NÃ¤tverkstrafik (`Network`) fÃ¶r misslyckade anrop eller ovÃ¤ntade svar frÃ¥n backend.
*   **Backend:** ğŸ“œ Granska loggarna frÃ¥n `FastAPI`-applikationen pÃ¥ servern. AnvÃ¤nd t.ex. `journalctl`:
    ```bash
    journalctl -u fastapi.service -n 50
    ```
*   **Samtal:** ğŸ“Š Analysera samtalsloggarna direkt i `Google Cloud Console` fÃ¶r `Dialogflow CX`. Detta hjÃ¤lper till att fÃ¶lja agentens exekvering och identifiera eventuella logikfel eller integrationsproblem.
*   **NÃ¤tverk:**
    *   ğŸ“¡ Isolera backend-problem genom att testa API-endpoints direkt med verktyg som `curl`.
    *   ğŸ›¡ï¸ Om `Nginx` anvÃ¤nds som reverse proxy, kontrollera dess felloggar fÃ¶r eventuella konfigurations- eller anslutningsproblem:
        ```bash
        sudo tail -f /var/log/nginx/fastapi_error.log
        ```